{% extends "core/tutor/base_tutor.html" %}

{% block title %}Students{% endblock %}

{% block content %}
<div class="page-header">
  <div>
    <h1 class="page-title">Students</h1>
    <p class="page-subtitle">Diagnostic overview</p>
  </div>
</div>

<div class="card">
  <div class="table-wrap">
    <table class="table">
      <thead>
        <tr>
          <th>Student</th>
          <th>Grade</th>
          <th>Score</th>
          <th>Weakest Topic</th>
          <th class="text-right"></th>
        </tr>
      </thead>

      <tbody>
        {% for row in rows %}
        <tr>
          <td class="fw-600">{{ row.student.user.username }}</td>
          <td>{{ row.student.grade_level }}</td>

          {% if row.latest %}
            <td>
              <span class="badge badge-primary">
                {{ row.latest.percent_score|floatformat:0 }}%
              </span>
            </td>
            <td>
              {% if row.weakest_topic %}
                <span class="badge badge-soft">{{ row.weakest_topic }}</span>
              {% else %}
                <span class="muted">—</span>
              {% endif %}
            </td>
          {% else %}
            <td><span class="badge badge-muted">No diagnostic</span></td>
            <td><span class="muted">—</span></td>
          {% endif %}

          <td class="text-right">
            <a class="link" href="{% url 'tutor_student_detail' row.student.id %}">View →</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="muted">No students found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
